{"ast":null,"code":"var _jsxFileName = \"/Users/lijinxing/Documents/hipo-dapp-bamboo/src/wallet/WalletProvider.jsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\n// eslint-disable-next-line\n\nimport { UnsupportedChainIdError, useWeb3React, Web3ReactProvider } from \"@web3-react/core\";\nimport { NoEthereumProviderError, UserRejectedRequestError } from \"@web3-react/injected-connector\";\nimport BigNumber from \"bignumber.js\";\nimport { ethers } from \"ethers\";\nimport { createContext, useCallback, useContext, useEffect, useMemo, useRef, useState } from \"react\";\nimport { useSessionStorage } from \"react-use-storage\";\nimport Web3 from \"web3\";\nimport EventEmitter from \"wolfy87-eventemitter\";\nimport { useChain } from \"../chain/ChainProvider\";\n// import Modal from \"../components/modal/Modal\";\nimport InstallMetamaskModal from \"./components/install-metamask-modal/InstallMetamaskModal\";\nimport SelectWalletModal from \"./components/select-wallet-modal/SelectWalletModal\";\n// import SwitchChainModal from \"./components/switch-chain-modal/SwitchChainModal\";\nimport MetamaskWalletConfig from \"./connectors/metamask/MetamaskConnector\";\n\n/* \n  Create wallet hook: useWallet() \n*/\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Context = /*#__PURE__*/createContext();\nexport function useWallet() {\n  _s();\n  return useContext(Context);\n}\n\n/* \n  Add other wallet connector \n*/\n_s(useWallet, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nexport const WalletConnectors = [MetamaskWalletConfig];\nconst Web3WalletProvider = props => {\n  _s2();\n  var _web3React$account;\n  const {\n    children\n  } = props;\n  const {\n    activeChain\n  } = useChain();\n  const web3React = useWeb3React();\n  const [sessionProvider, setSessionProvider, removeSessionProvider] = useSessionStorage('wallet_provider');\n  const event = useMemo(() => new EventEmitter(), []);\n  const [connecting, setConnecting] = useState();\n  const [initialized, setInitialized] = useState(false);\n  const connectingRef = useRef(connecting);\n\n  /* \n    TODO: Test: Is it possible to remove this line \n  */\n\n  connectingRef.current = connecting;\n  const [activeMeta, setActiveMeta] = useState();\n\n  /* \n    Account states \n  */\n\n  const [ethBalance, setEthBalance] = useState();\n  const [ensName, setENSName] = useState();\n  const [ensAvatar, setENSAvatar] = useState();\n\n  /* \n    Modal controllers \n  */\n\n  const [selectWalletModal, setSelectWalletModal] = useState(false);\n  const [installMetaMaskModal, setInstallMetaMaskModal] = useState(false);\n  // const [unsupportedChainModal, setUnsupportedChainModal] = useState(false);\n  // const [userRejectedModal, setUserRejectedModal] = useState(false);\n\n  /* \n    \n  */\n\n  const preConnectedAccount = useRef(web3React.account);\n  if (preConnectedAccount.current !== web3React.account) {\n    preConnectedAccount.current = web3React.account;\n    event.emit('UPDATE_ACCOUNT', web3React.account);\n  }\n\n  /* \n    Disconnect wallet handler \n  */\n\n  const disconnect = useCallback(() => {\n    var _activeMeta$onDisconn;\n    web3React.deactivate();\n    activeMeta === null || activeMeta === void 0 ? void 0 : (_activeMeta$onDisconn = activeMeta.onDisconnect) === null || _activeMeta$onDisconn === void 0 ? void 0 : _activeMeta$onDisconn.call(activeMeta, web3React.connector);\n    setConnecting(undefined);\n    setActiveMeta(undefined);\n    setEthBalance(undefined);\n    removeSessionProvider();\n  }, [web3React, activeMeta, removeSessionProvider, setConnecting, setActiveMeta, setEthBalance]);\n\n  /* \n    Connect wallet handler \n  */\n\n  const connect = useCallback(async walletConfig => {\n    /* The status of connecting */\n\n    if (connectingRef.current) {\n      return;\n    }\n    connectingRef.current = walletConfig;\n    setConnecting(walletConfig);\n    setSelectWalletModal(false);\n    setInstallMetaMaskModal(false);\n    // setUnsupportedChainModal(false);\n    // setUserRejectedModal(false);\n\n    const connector = walletConfig.factory(activeChain);\n\n    /* Errors handlers: \n    /* No wallet available, \n    /* unsupported chain, \n    /* user rejected connection request, \n    /* and other errors. */\n\n    function onError(error) {\n      if (error instanceof NoEthereumProviderError) {\n        setInstallMetaMaskModal(true);\n        disconnect();\n      } else if (error instanceof UnsupportedChainIdError) {\n        // setUnsupportedChainModal(true)\n        disconnect();\n      } else if (error instanceof UserRejectedRequestError) {\n        // setUserRejectedModal(true)\n        disconnect();\n      } else {\n        var _walletConfig$onError;\n        const err = (_walletConfig$onError = walletConfig.onError) === null || _walletConfig$onError === void 0 ? void 0 : _walletConfig$onError.call(walletConfig, error);\n        if (err) {\n          console.log(err.message);\n        }\n        disconnect();\n      }\n    }\n    function onSuccess() {\n      var _walletConfig$onConne;\n      console.log('this should be executed at beginning');\n      if (!connectingRef.current) {\n        return;\n      }\n      (_walletConfig$onConne = walletConfig.onConnect) === null || _walletConfig$onConne === void 0 ? void 0 : _walletConfig$onConne.call(walletConfig, connector);\n      setActiveMeta(walletConfig);\n      setSessionProvider(walletConfig.id);\n      console.log('this should be executed');\n    }\n    await web3React.activate(connector, undefined, true).then(() => {\n      console.log('Promise resolved');\n      onSuccess();\n    }).catch(onError);\n    setConnecting(undefined);\n\n    // try {\n\n    //   const currentProviderChainId = await connector.getChainId()\n\n    //   if(currentProviderChainId === activeNetwork.metamaskChain.chainId) {\n    //     await web3React.activate(connector, undefined, true)\n    //       .then(onSuccess)\n    //       .catch(onError)\n    //   } else {\n    //     setUnsupportedChainModal(true);\n    //   }\n\n    //   setConnecting(undefined);\n\n    // } catch(error) {\n    //   if(error instanceof NoEthereumProviderError) {\n    //     setInstallMetaMaskModal(true)\n    //     disconnect()\n    //   }\n    // }       \n  }, [web3React, connectingRef, setConnecting, setSessionProvider, activeChain, disconnect]);\n  const changeChain = async setError => {\n    try {\n      if (!window.ethereum) throw new Error(\"No crypto wallet found\");\n      if (activeChain.meta.chainId === 1 || activeChain.meta.chainId === 5) {\n        await window.ethereum.request({\n          method: \"wallet_switchEthereumChain\",\n          params: [{\n            \"chainId\": `0x${Number(activeChain.meta.chainId).toString(16)}`\n          }]\n        });\n      } else {\n        await window.ethereum.request({\n          method: \"wallet_addEthereumChain\",\n          params: [{\n            \"chainId\": `0x${Number(activeChain.meta.chainId).toString(16)}`\n          }]\n        });\n      }\n    } catch (err) {\n      setError(err.message);\n    }\n  };\n\n  /* \n    Use effect to update the account states \n  */\n\n  useEffect(() => {\n    /* Reset account states to undefined */\n\n    setEthBalance(undefined);\n    setENSName(undefined);\n    setENSAvatar(undefined);\n    const account = web3React.account;\n    console.log('wallet provider account:', account);\n    if (account && Web3.utils.isAddress(account)) {\n      const ethWeb3 = new Web3(web3React.library);\n\n      /* Balance of the account */\n\n      ethWeb3.eth.getBalance(account).then(value => {\n        setEthBalance(value ? new BigNumber(value) : undefined);\n      }).catch(Error);\n\n      /* ENS name and avatar of the account */\n\n      const provider = new ethers.providers.JsonRpcProvider(activeChain.rpc.httpsUrl);\n      provider.lookupAddress(account).then(value => {\n        setENSName(value !== null && value !== void 0 ? value : undefined);\n        if (value) {\n          provider.getAvatar(value !== null && value !== void 0 ? value : '').then(value => {\n            setENSAvatar(value !== null && value !== void 0 ? value : undefined);\n          }).catch(Error);\n        }\n      }).catch(Error);\n    }\n  }, [web3React.account, activeChain, web3React.library]);\n\n  /* \n    Accroding to session to restore states of the account \n  */\n\n  useEffect(() => {\n    (async () => {\n      if (sessionProvider) {\n        const walletConnector = WalletConnectors.find(conn => conn.id === sessionProvider);\n        if (walletConnector) {\n          await connect(walletConnector);\n        }\n      }\n      setInitialized(true);\n    })();\n    // eslint-disable-next-line\n  }, []);\n  const value = {\n    initialized,\n    connecting,\n    isActive: web3React.active,\n    account: (_web3React$account = web3React.account) !== null && _web3React$account !== void 0 ? _web3React$account : undefined,\n    meta: activeMeta,\n    connector: web3React.connector,\n    provider: web3React.library,\n    ethBalance,\n    connect,\n    disconnect,\n    showWalletsModal: () => {\n      setSelectWalletModal(true);\n    },\n    closeSelectWalletModal: () => {\n      setSelectWalletModal(false);\n    },\n    closeInstallWalletModal: () => {\n      setInstallMetaMaskModal(false);\n    },\n    showSwichChainModal: () => {\n      // setUnsupportedChainModal(false);\n    },\n    changeChain,\n    event,\n    ens: {\n      name: ensName,\n      avatar: ensAvatar\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(Context.Provider, {\n    value: value,\n    children: [children, selectWalletModal && /*#__PURE__*/_jsxDEV(SelectWalletModal, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 316,\n      columnNumber: 30\n    }, this), installMetaMaskModal && /*#__PURE__*/_jsxDEV(InstallMetamaskModal, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 319,\n      columnNumber: 33\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 314,\n    columnNumber: 5\n  }, this);\n};\n_s2(Web3WalletProvider, \"E/lq8UYiVUe8fW+GvzsS/RqpK9o=\", false, function () {\n  return [useChain, useWeb3React, useSessionStorage];\n});\n_c = Web3WalletProvider;\nconst WalletProvider = props => {\n  const {\n    children\n  } = props;\n  return /*#__PURE__*/_jsxDEV(Web3ReactProvider, {\n    getLibrary: library => library,\n    children: /*#__PURE__*/_jsxDEV(Web3WalletProvider, {\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 330,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 329,\n    columnNumber: 5\n  }, this);\n};\n_c2 = WalletProvider;\nexport default WalletProvider;\nvar _c, _c2;\n$RefreshReg$(_c, \"Web3WalletProvider\");\n$RefreshReg$(_c2, \"WalletProvider\");","map":{"version":3,"names":["UnsupportedChainIdError","useWeb3React","Web3ReactProvider","NoEthereumProviderError","UserRejectedRequestError","BigNumber","ethers","createContext","useCallback","useContext","useEffect","useMemo","useRef","useState","useSessionStorage","Web3","EventEmitter","useChain","InstallMetamaskModal","SelectWalletModal","MetamaskWalletConfig","jsxDEV","_jsxDEV","Context","useWallet","_s","WalletConnectors","Web3WalletProvider","props","_s2","_web3React$account","children","activeChain","web3React","sessionProvider","setSessionProvider","removeSessionProvider","event","connecting","setConnecting","initialized","setInitialized","connectingRef","current","activeMeta","setActiveMeta","ethBalance","setEthBalance","ensName","setENSName","ensAvatar","setENSAvatar","selectWalletModal","setSelectWalletModal","installMetaMaskModal","setInstallMetaMaskModal","preConnectedAccount","account","emit","disconnect","_activeMeta$onDisconn","deactivate","onDisconnect","call","connector","undefined","connect","walletConfig","factory","onError","error","_walletConfig$onError","err","console","log","message","onSuccess","_walletConfig$onConne","onConnect","id","activate","then","catch","changeChain","setError","window","ethereum","Error","meta","chainId","request","method","params","Number","toString","utils","isAddress","ethWeb3","library","eth","getBalance","value","provider","providers","JsonRpcProvider","rpc","httpsUrl","lookupAddress","getAvatar","walletConnector","find","conn","isActive","active","showWalletsModal","closeSelectWalletModal","closeInstallWalletModal","showSwichChainModal","ens","name","avatar","Provider","fileName","_jsxFileName","lineNumber","columnNumber","_c","WalletProvider","getLibrary","_c2","$RefreshReg$"],"sources":["/Users/lijinxing/Documents/hipo-dapp-bamboo/src/wallet/WalletProvider.jsx"],"sourcesContent":["// eslint-disable-next-line\n\nimport { UnsupportedChainIdError, useWeb3React, Web3ReactProvider } from \"@web3-react/core\";\nimport { NoEthereumProviderError, UserRejectedRequestError } from \"@web3-react/injected-connector\";\nimport BigNumber from \"bignumber.js\";\nimport { ethers } from \"ethers\";\nimport { createContext, useCallback, useContext, useEffect, useMemo, useRef, useState } from \"react\";\nimport { useSessionStorage } from \"react-use-storage\";\nimport Web3 from \"web3\";\nimport EventEmitter from \"wolfy87-eventemitter\";\nimport { useChain } from \"../chain/ChainProvider\";\n// import Modal from \"../components/modal/Modal\";\nimport InstallMetamaskModal from \"./components/install-metamask-modal/InstallMetamaskModal\";\nimport SelectWalletModal from \"./components/select-wallet-modal/SelectWalletModal\";\n// import SwitchChainModal from \"./components/switch-chain-modal/SwitchChainModal\";\nimport MetamaskWalletConfig from \"./connectors/metamask/MetamaskConnector\";\n\n/* \n  Create wallet hook: useWallet() \n*/\n\nconst Context = createContext();\n\nexport function useWallet() {\n  return useContext(Context);\n}\n\n/* \n  Add other wallet connector \n*/\n\nexport const WalletConnectors = [\n  MetamaskWalletConfig,\n];\n\nconst Web3WalletProvider = props => {\n\n  const { children } = props;\n  const { activeChain } = useChain();\n  const web3React = useWeb3React();\n\n  const [sessionProvider, setSessionProvider, removeSessionProvider] = useSessionStorage('wallet_provider');\n  const event = useMemo(() => new EventEmitter(), [])\n  const [connecting, setConnecting] = useState();\n  const [initialized, setInitialized] = useState(false);\n  const connectingRef = useRef(connecting);\n\n  /* \n    TODO: Test: Is it possible to remove this line \n  */\n\n  connectingRef.current = connecting;\n  const [activeMeta, setActiveMeta] = useState();\n\n  /* \n    Account states \n  */\n\n  const [ethBalance, setEthBalance] = useState();\n  const [ensName, setENSName] = useState();\n  const [ensAvatar, setENSAvatar]= useState();\n\n  /* \n    Modal controllers \n  */\n\n  const [selectWalletModal, setSelectWalletModal] = useState(false);\n  const [installMetaMaskModal, setInstallMetaMaskModal] = useState(false);\n  // const [unsupportedChainModal, setUnsupportedChainModal] = useState(false);\n  // const [userRejectedModal, setUserRejectedModal] = useState(false);\n\n  /* \n    \n  */\n\n  const preConnectedAccount = useRef(web3React.account)\n  if (preConnectedAccount.current !== web3React.account) {\n    preConnectedAccount.current = web3React.account\n    event.emit('UPDATE_ACCOUNT', web3React.account)\n  }\n\n  /* \n    Disconnect wallet handler \n  */\n\n  const disconnect = useCallback(() => {\n    web3React.deactivate()\n    activeMeta?.onDisconnect?.(web3React.connector)\n    setConnecting(undefined)\n    setActiveMeta(undefined)\n    setEthBalance(undefined)\n    removeSessionProvider()\n  }, [web3React, activeMeta, removeSessionProvider, setConnecting, setActiveMeta, setEthBalance])\n\n  /* \n    Connect wallet handler \n  */\n\n  const connect = useCallback(\n    async (walletConfig) => {\n\n      /* The status of connecting */\n\n      if(connectingRef.current) {\n        return\n      }\n\n      connectingRef.current = walletConfig\n      setConnecting(walletConfig);\n\n      setSelectWalletModal(false);\n      setInstallMetaMaskModal(false);\n      // setUnsupportedChainModal(false);\n      // setUserRejectedModal(false);\n\n      const connector = walletConfig.factory(activeChain);\n\n      /* Errors handlers: \n      /* No wallet available, \n      /* unsupported chain, \n      /* user rejected connection request, \n      /* and other errors. */\n      \n      function onError(error) {\n        if(error instanceof NoEthereumProviderError) {\n          setInstallMetaMaskModal(true)\n          disconnect()\n        } else if(error instanceof UnsupportedChainIdError) {\n          // setUnsupportedChainModal(true)\n          disconnect()\n        } else if(error instanceof UserRejectedRequestError) {\n          // setUserRejectedModal(true)\n          disconnect()\n        } else {\n          const err = walletConfig.onError?.(error)\n          \n          if(err) {\n            console.log(err.message);\n          }\n          disconnect()\n        }\n      }\n\n      function onSuccess() {\n        console.log('this should be executed at beginning');\n        if (!connectingRef.current) {\n          return\n        }\n\n        walletConfig.onConnect?.(connector)\n        setActiveMeta(walletConfig)\n        setSessionProvider(walletConfig.id)\n        console.log('this should be executed');\n      }\n\n      await web3React.activate(connector, undefined, true)\n      .then(() => {\n        console.log('Promise resolved');\n        onSuccess();\n      })\n      .catch(onError);      \n      setConnecting(undefined)\n\n      // try {\n        \n      //   const currentProviderChainId = await connector.getChainId()\n        \n      //   if(currentProviderChainId === activeNetwork.metamaskChain.chainId) {\n      //     await web3React.activate(connector, undefined, true)\n      //       .then(onSuccess)\n      //       .catch(onError)\n      //   } else {\n      //     setUnsupportedChainModal(true);\n      //   }\n        \n      //   setConnecting(undefined);\n\n      // } catch(error) {\n      //   if(error instanceof NoEthereumProviderError) {\n      //     setInstallMetaMaskModal(true)\n      //     disconnect()\n      //   }\n      // }       \n    },\n    [web3React, connectingRef, setConnecting, setSessionProvider, activeChain, disconnect],\n  )\n\n  const changeChain = async (setError) => {\n    try {\n      if (!window.ethereum) throw new Error(\"No crypto wallet found\");\n\n      if (activeChain.meta.chainId === 1 || activeChain.meta.chainId === 5) {\n        await window.ethereum.request({\n          method: \"wallet_switchEthereumChain\",\n          params: [\n            {\n              \"chainId\": `0x${Number(activeChain.meta.chainId).toString(16)}`,\n            }\n          ]\n        });\n      } else {\n        await window.ethereum.request({\n          method: \"wallet_addEthereumChain\",          \n          params: [\n            {\n              \"chainId\": `0x${Number(activeChain.meta.chainId).toString(16)}`,\n            }\n          ]\n        });\n      }\n      \n    } catch (err) {\n      setError(err.message);\n    }\n  };\n\n  /* \n    Use effect to update the account states \n  */\n\n  useEffect(() => {\n\n    /* Reset account states to undefined */\n\n    setEthBalance(undefined);\n    setENSName(undefined);\n    setENSAvatar(undefined);\n\n    const account = web3React.account;\n    console.log('wallet provider account:', account);\n\n    if(account && Web3.utils.isAddress(account)) {\n      const ethWeb3 = new Web3(web3React.library);\n\n      /* Balance of the account */\n\n      ethWeb3.eth\n        .getBalance(account)\n        .then(value => {\n          setEthBalance(value ? new BigNumber(value) : undefined);\n        })\n        .catch(Error);\n      \n      /* ENS name and avatar of the account */\n\n      const provider = new ethers.providers.JsonRpcProvider(activeChain.rpc.httpsUrl);\n      provider\n        .lookupAddress(account)\n        .then(value => {\n          setENSName(value ?? undefined);\n          if(value) {\n            provider\n              .getAvatar(value ?? '')\n              .then(value => {\n                setENSAvatar(value ?? undefined);\n              })\n              .catch(Error);\n          }\n        })\n        .catch(Error)\n    }\n  }, [web3React.account, activeChain, web3React.library])\n\n  /* \n    Accroding to session to restore states of the account \n  */\n  \n  useEffect(() => {\n    (async () => {\n      if(sessionProvider) {\n        const walletConnector = WalletConnectors.find(conn => conn.id === sessionProvider);\n\n        if(walletConnector) {\n          await connect(walletConnector)\n        }\n      }\n      setInitialized(true);\n    })()\n  // eslint-disable-next-line\n  },[])\n\n  const value = {\n    initialized,\n    connecting,\n    isActive: web3React.active,\n    account: web3React.account ?? undefined,\n    meta: activeMeta,\n    connector: web3React.connector,\n    provider: web3React.library,\n    ethBalance,\n    connect,\n    disconnect,\n    showWalletsModal: () => {\n      setSelectWalletModal(true);\n    },\n    closeSelectWalletModal: () => {\n      setSelectWalletModal(false)\n    },\n    closeInstallWalletModal: () => {\n      setInstallMetaMaskModal(false)\n    },\n    showSwichChainModal: () => {\n      // setUnsupportedChainModal(false);\n    },\n    changeChain,\n    event,\n    ens: {\n      name: ensName,\n      avatar: ensAvatar,\n    }\n  }\n\n  return (\n    <Context.Provider value={value}>\n      { children }\n      { selectWalletModal && <SelectWalletModal /> }\n      {/* { userRejectedModal && <Modal />}\n      { unsupportedChainModal && <SwitchChainModal />} */}\n      { installMetaMaskModal && <InstallMetamaskModal />}\n    </Context.Provider>\n  )\n}\n\nconst WalletProvider = props => {\n\n  const { children } = props\n\n  return (\n    <Web3ReactProvider getLibrary={library => library}>\n      <Web3WalletProvider>\n        { children }\n      </Web3WalletProvider>\n    </Web3ReactProvider>\n  )\n}\n\nexport default WalletProvider\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}