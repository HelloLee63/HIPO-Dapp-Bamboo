{"ast":null,"code":"var _jsxFileName = \"/Users/lijinxing/Documents/hipo-dapp-bamboo/src/wallet/WalletProvider.jsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\n// eslint-disable-next-line\n\nimport { UnsupportedChainIdError, useWeb3React, Web3ReactProvider } from \"@web3-react/core\";\nimport { NoEthereumProviderError, UserRejectedRequestError } from \"@web3-react/injected-connector\";\nimport BigNumber from \"bignumber.js\";\nimport { ethers } from \"ethers\";\nimport { createContext, useCallback, useContext, useEffect, useMemo, useRef, useState } from \"react\";\nimport { useSessionStorage } from \"react-use-storage\";\nimport Web3 from \"web3\";\nimport EventEmitter from \"wolfy87-eventemitter\";\nimport { useChain } from \"../chain/ChainProvider\";\n// import Modal from \"../components/modal/Modal\";\nimport InstallMetamaskModal from \"./components/install-metamask-modal/InstallMetamaskModal\";\nimport SelectWalletModal from \"./components/select-wallet-modal/SelectWalletModal\";\n// import SwitchChainModal from \"./components/switch-chain-modal/SwitchChainModal\";\nimport MetamaskWalletConfig from \"./connectors/metamask/MetamaskConnector\";\n\n/* \n  Create wallet hook: useWallet() \n*/\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Context = /*#__PURE__*/createContext();\nexport function useWallet() {\n  _s();\n  return useContext(Context);\n}\n\n/* \n  Add other wallet connector \n*/\n_s(useWallet, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nexport const WalletConnectors = [MetamaskWalletConfig];\nconst Web3WalletProvider = props => {\n  _s2();\n  var _web3React$account;\n  const {\n    children\n  } = props;\n  const {\n    activeChain\n  } = useChain();\n  const web3React = useWeb3React();\n  const [sessionProvider, setSessionProvider, removeSessionProvider] = useSessionStorage('wallet_provider');\n  const event = useMemo(() => new EventEmitter(), []);\n  const [connecting, setConnecting] = useState();\n  const [initialized, setInitialized] = useState(false);\n  const connectingRef = useRef(connecting);\n\n  /* \n    TODO: Test: Is it possible to remove this line \n  */\n\n  connectingRef.current = connecting;\n  const [activeMeta, setActiveMeta] = useState();\n\n  /* \n    Account states \n  */\n\n  const [ethBalance, setEthBalance] = useState();\n  const [ensName, setENSName] = useState();\n  const [ensAvatar, setENSAvatar] = useState();\n\n  /* \n    Modal controllers \n  */\n\n  const [selectWalletModal, setSelectWalletModal] = useState(false);\n  const [installMetaMaskModal, setInstallMetaMaskModal] = useState(false);\n  // const [unsupportedChainModal, setUnsupportedChainModal] = useState(false);\n  // const [userRejectedModal, setUserRejectedModal] = useState(false);\n\n  /* \n    \n  */\n\n  const preConnectedAccount = useRef(web3React.account);\n  if (preConnectedAccount.current !== web3React.account) {\n    preConnectedAccount.current = web3React.account;\n    event.emit('UPDATE_ACCOUNT', web3React.account);\n  }\n\n  /* \n    Disconnect wallet handler \n  */\n\n  const disconnect = useCallback(() => {\n    var _activeMeta$onDisconn;\n    web3React.deactivate();\n    activeMeta === null || activeMeta === void 0 ? void 0 : (_activeMeta$onDisconn = activeMeta.onDisconnect) === null || _activeMeta$onDisconn === void 0 ? void 0 : _activeMeta$onDisconn.call(activeMeta, web3React.connector);\n    setConnecting(undefined);\n    setActiveMeta(undefined);\n    setEthBalance(undefined);\n    removeSessionProvider();\n  }, [web3React, activeMeta, removeSessionProvider, setConnecting, setActiveMeta, setEthBalance]);\n\n  /* \n    Connect wallet handler \n  */\n\n  const connect = useCallback(async walletConfig => {\n    /* The status of connecting */\n\n    if (connectingRef.current) {\n      return;\n    }\n    connectingRef.current = walletConfig;\n    setConnecting(walletConfig);\n    setConnectWalletModal(false);\n    setInstallMetaMaskModal(false);\n    setUnsupportedChainModal(false);\n    setUserRejectedModal(false);\n    const connector = walletConfig.factory(activeNetwork);\n\n    /* Errors handlers: \n    /* No wallet available, \n    /* unsupported chain, \n    /* user rejected connection request, \n    /* and other errors. */\n\n    function onError(error) {\n      if (error instanceof NoEthereumProviderError) {\n        setInstallMetaMaskModal(true);\n        disconnect();\n      } else if (error instanceof UnsupportedChainIdError) {\n        setUnsupportedChainModal(true);\n        disconnect();\n      } else if (error instanceof UserRejectedRequestError) {\n        setUserRejectedModal(true);\n        disconnect();\n      } else {\n        var _walletConfig$onError;\n        const err = (_walletConfig$onError = walletConfig.onError) === null || _walletConfig$onError === void 0 ? void 0 : _walletConfig$onError.call(walletConfig, error);\n        if (err) {\n          console.log(err.message);\n        }\n        disconnect();\n      }\n    }\n    function onSuccess() {\n      var _walletConfig$onConne;\n      if (!connectingRef.current) {\n        return;\n      }\n      (_walletConfig$onConne = walletConfig.onConnect) === null || _walletConfig$onConne === void 0 ? void 0 : _walletConfig$onConne.call(walletConfig, connector);\n      setActiveMeta(walletConfig);\n      setSessionProvider(walletConfig.id);\n      console.log('this should be executed');\n    }\n    await web3React.activate(connector, undefined, true).then(onSuccess).catch(onError);\n    setConnecting(undefined);\n\n    // try {\n\n    //   const currentProviderChainId = await connector.getChainId()\n\n    //   if(currentProviderChainId === activeNetwork.metamaskChain.chainId) {\n    //     await web3React.activate(connector, undefined, true)\n    //       .then(onSuccess)\n    //       .catch(onError)\n    //   } else {\n    //     setUnsupportedChainModal(true);\n    //   }\n\n    //   setConnecting(undefined);\n\n    // } catch(error) {\n    //   if(error instanceof NoEthereumProviderError) {\n    //     setInstallMetaMaskModal(true)\n    //     disconnect()\n    //   }\n    // }       \n  }, [web3React, connectingRef, setConnecting, setSessionProvider, activeNetwork, disconnect]);\n  const changeChain = async setError => {\n    try {\n      if (!window.ethereum) throw new Error(\"No crypto wallet found\");\n      if (activeChain.meta.chainId === 1 || activeChain.meta.chainId === 5) {\n        await window.ethereum.request({\n          method: \"wallet_switchEthereumChain\",\n          params: [{\n            \"chainId\": `0x${Number(activeChain.meta.chainId).toString(16)}`\n          }]\n        });\n      } else {\n        await window.ethereum.request({\n          method: \"wallet_addEthereumChain\",\n          params: [{\n            \"chainId\": `0x${Number(activeChain.meta.chainId).toString(16)}`\n          }]\n        });\n      }\n    } catch (err) {\n      setError(err.message);\n    }\n  };\n\n  /* \n    Use effect to update the account states \n  */\n\n  useEffect(() => {\n    /* Reset account states to undefined */\n\n    setEthBalance(undefined);\n    setENSName(undefined);\n    setENSAvatar(undefined);\n    const account = web3React.account;\n    console.log('wallet provider account:', account);\n    if (account && Web3.utils.isAddress(account)) {\n      const ethWeb3 = new Web3(web3React.library);\n\n      /* Balance of the account */\n\n      ethWeb3.eth.getBalance(account).then(value => {\n        setEthBalance(value ? new BigNumber(value) : undefined);\n      }).catch(Error);\n\n      /* ENS name and avatar of the account */\n\n      const provider = new ethers.providers.JsonRpcProvider(activeChain.rpc.httpsUrl);\n      provider.lookupAddress(account).then(value => {\n        setENSName(value !== null && value !== void 0 ? value : undefined);\n        if (value) {\n          provider.getAvatar(value !== null && value !== void 0 ? value : '').then(value => {\n            setENSAvatar(value !== null && value !== void 0 ? value : undefined);\n          }).catch(Error);\n        }\n      }).catch(Error);\n    }\n  }, [web3React.account, activeChain, web3React.library]);\n\n  /* \n    Accroding to session to restore states of the account \n  */\n\n  useEffect(() => {\n    (async () => {\n      if (sessionProvider) {\n        const walletConnector = WalletConnectors.find(conn => conn.id === sessionProvider);\n        if (walletConnector) {\n          await connect(walletConnector);\n        }\n      }\n      setInitialized(true);\n    })();\n    // eslint-disable-next-line\n  }, []);\n  const value = {\n    initialized,\n    connecting,\n    isActive: web3React.active,\n    account: (_web3React$account = web3React.account) !== null && _web3React$account !== void 0 ? _web3React$account : undefined,\n    meta: activeMeta,\n    connector: web3React.connector,\n    provider: web3React.library,\n    ethBalance,\n    connect,\n    disconnect,\n    showWalletsModal: () => {\n      setSelectWalletModal(true);\n    },\n    closeSelectWalletModal: () => {\n      setSelectWalletModal(false);\n    },\n    closeInstallWalletModal: () => {\n      setInstallMetaMaskModal(false);\n    },\n    showSwichChainModal: () => {\n      // setUnsupportedChainModal(false);\n    },\n    changeChain,\n    event,\n    ens: {\n      name: ensName,\n      avatar: ensAvatar\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(Context.Provider, {\n    value: value,\n    children: [children, selectWalletModal && /*#__PURE__*/_jsxDEV(SelectWalletModal, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 310,\n      columnNumber: 30\n    }, this), installMetaMaskModal && /*#__PURE__*/_jsxDEV(InstallMetamaskModal, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 313,\n      columnNumber: 33\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 308,\n    columnNumber: 5\n  }, this);\n};\n_s2(Web3WalletProvider, \"E/lq8UYiVUe8fW+GvzsS/RqpK9o=\", false, function () {\n  return [useChain, useWeb3React, useSessionStorage];\n});\n_c = Web3WalletProvider;\nconst WalletProvider = props => {\n  const {\n    children\n  } = props;\n  return /*#__PURE__*/_jsxDEV(Web3ReactProvider, {\n    getLibrary: library => library,\n    children: /*#__PURE__*/_jsxDEV(Web3WalletProvider, {\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 324,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 323,\n    columnNumber: 5\n  }, this);\n};\n_c2 = WalletProvider;\nexport default WalletProvider;\nvar _c, _c2;\n$RefreshReg$(_c, \"Web3WalletProvider\");\n$RefreshReg$(_c2, \"WalletProvider\");","map":{"version":3,"names":["UnsupportedChainIdError","useWeb3React","Web3ReactProvider","NoEthereumProviderError","UserRejectedRequestError","BigNumber","ethers","createContext","useCallback","useContext","useEffect","useMemo","useRef","useState","useSessionStorage","Web3","EventEmitter","useChain","InstallMetamaskModal","SelectWalletModal","MetamaskWalletConfig","jsxDEV","_jsxDEV","Context","useWallet","_s","WalletConnectors","Web3WalletProvider","props","_s2","_web3React$account","children","activeChain","web3React","sessionProvider","setSessionProvider","removeSessionProvider","event","connecting","setConnecting","initialized","setInitialized","connectingRef","current","activeMeta","setActiveMeta","ethBalance","setEthBalance","ensName","setENSName","ensAvatar","setENSAvatar","selectWalletModal","setSelectWalletModal","installMetaMaskModal","setInstallMetaMaskModal","preConnectedAccount","account","emit","disconnect","_activeMeta$onDisconn","deactivate","onDisconnect","call","connector","undefined","connect","walletConfig","setConnectWalletModal","setUnsupportedChainModal","setUserRejectedModal","factory","activeNetwork","onError","error","_walletConfig$onError","err","console","log","message","onSuccess","_walletConfig$onConne","onConnect","id","activate","then","catch","changeChain","setError","window","ethereum","Error","meta","chainId","request","method","params","Number","toString","utils","isAddress","ethWeb3","library","eth","getBalance","value","provider","providers","JsonRpcProvider","rpc","httpsUrl","lookupAddress","getAvatar","walletConnector","find","conn","isActive","active","showWalletsModal","closeSelectWalletModal","closeInstallWalletModal","showSwichChainModal","ens","name","avatar","Provider","fileName","_jsxFileName","lineNumber","columnNumber","_c","WalletProvider","getLibrary","_c2","$RefreshReg$"],"sources":["/Users/lijinxing/Documents/hipo-dapp-bamboo/src/wallet/WalletProvider.jsx"],"sourcesContent":["// eslint-disable-next-line\n\nimport { UnsupportedChainIdError, useWeb3React, Web3ReactProvider } from \"@web3-react/core\";\nimport { NoEthereumProviderError, UserRejectedRequestError } from \"@web3-react/injected-connector\";\nimport BigNumber from \"bignumber.js\";\nimport { ethers } from \"ethers\";\nimport { createContext, useCallback, useContext, useEffect, useMemo, useRef, useState } from \"react\";\nimport { useSessionStorage } from \"react-use-storage\";\nimport Web3 from \"web3\";\nimport EventEmitter from \"wolfy87-eventemitter\";\nimport { useChain } from \"../chain/ChainProvider\";\n// import Modal from \"../components/modal/Modal\";\nimport InstallMetamaskModal from \"./components/install-metamask-modal/InstallMetamaskModal\";\nimport SelectWalletModal from \"./components/select-wallet-modal/SelectWalletModal\";\n// import SwitchChainModal from \"./components/switch-chain-modal/SwitchChainModal\";\nimport MetamaskWalletConfig from \"./connectors/metamask/MetamaskConnector\";\n\n/* \n  Create wallet hook: useWallet() \n*/\n\nconst Context = createContext();\n\nexport function useWallet() {\n  return useContext(Context);\n}\n\n/* \n  Add other wallet connector \n*/\n\nexport const WalletConnectors = [\n  MetamaskWalletConfig,\n];\n\nconst Web3WalletProvider = props => {\n\n  const { children } = props;\n  const { activeChain } = useChain();\n  const web3React = useWeb3React();\n\n  const [sessionProvider, setSessionProvider, removeSessionProvider] = useSessionStorage('wallet_provider');\n  const event = useMemo(() => new EventEmitter(), [])\n  const [connecting, setConnecting] = useState();\n  const [initialized, setInitialized] = useState(false);\n  const connectingRef = useRef(connecting);\n\n  /* \n    TODO: Test: Is it possible to remove this line \n  */\n\n  connectingRef.current = connecting;\n  const [activeMeta, setActiveMeta] = useState();\n\n  /* \n    Account states \n  */\n\n  const [ethBalance, setEthBalance] = useState();\n  const [ensName, setENSName] = useState();\n  const [ensAvatar, setENSAvatar]= useState();\n\n  /* \n    Modal controllers \n  */\n\n  const [selectWalletModal, setSelectWalletModal] = useState(false);\n  const [installMetaMaskModal, setInstallMetaMaskModal] = useState(false);\n  // const [unsupportedChainModal, setUnsupportedChainModal] = useState(false);\n  // const [userRejectedModal, setUserRejectedModal] = useState(false);\n\n  /* \n    \n  */\n\n  const preConnectedAccount = useRef(web3React.account)\n  if (preConnectedAccount.current !== web3React.account) {\n    preConnectedAccount.current = web3React.account\n    event.emit('UPDATE_ACCOUNT', web3React.account)\n  }\n\n  /* \n    Disconnect wallet handler \n  */\n\n  const disconnect = useCallback(() => {\n    web3React.deactivate()\n    activeMeta?.onDisconnect?.(web3React.connector)\n    setConnecting(undefined)\n    setActiveMeta(undefined)\n    setEthBalance(undefined)\n    removeSessionProvider()\n  }, [web3React, activeMeta, removeSessionProvider, setConnecting, setActiveMeta, setEthBalance])\n\n  /* \n    Connect wallet handler \n  */\n\n    const connect = useCallback(\n      async (walletConfig) => {\n  \n        /* The status of connecting */\n  \n        if(connectingRef.current) {\n          return\n        }\n  \n        connectingRef.current = walletConfig\n        setConnecting(walletConfig);\n  \n        setConnectWalletModal(false);\n        setInstallMetaMaskModal(false);\n        setUnsupportedChainModal(false);\n        setUserRejectedModal(false);\n  \n        const connector = walletConfig.factory(activeNetwork);\n  \n        /* Errors handlers: \n        /* No wallet available, \n        /* unsupported chain, \n        /* user rejected connection request, \n        /* and other errors. */\n        \n        function onError(error) {\n          if(error instanceof NoEthereumProviderError) {\n            setInstallMetaMaskModal(true)\n            disconnect()\n          } else if(error instanceof UnsupportedChainIdError) {\n            setUnsupportedChainModal(true)\n            disconnect()\n          } else if(error instanceof UserRejectedRequestError) {\n            setUserRejectedModal(true)\n            disconnect()\n          } else {\n            const err = walletConfig.onError?.(error)\n            \n            if(err) {\n              console.log(err.message);\n            }\n            disconnect()\n          }\n        }\n  \n        function onSuccess() {\n          if (!connectingRef.current) {\n            return\n          }\n  \n          walletConfig.onConnect?.(connector)\n          setActiveMeta(walletConfig)\n          setSessionProvider(walletConfig.id)\n          console.log('this should be executed');\n        }\n  \n        await web3React.activate(connector, undefined, true).then(onSuccess).catch(onError)\n        setConnecting(undefined)\n  \n        // try {\n          \n        //   const currentProviderChainId = await connector.getChainId()\n          \n        //   if(currentProviderChainId === activeNetwork.metamaskChain.chainId) {\n        //     await web3React.activate(connector, undefined, true)\n        //       .then(onSuccess)\n        //       .catch(onError)\n        //   } else {\n        //     setUnsupportedChainModal(true);\n        //   }\n          \n        //   setConnecting(undefined);\n  \n        // } catch(error) {\n        //   if(error instanceof NoEthereumProviderError) {\n        //     setInstallMetaMaskModal(true)\n        //     disconnect()\n        //   }\n        // }       \n      },\n      [web3React, connectingRef, setConnecting, setSessionProvider, activeNetwork, disconnect],\n    )\n\n  const changeChain = async (setError) => {\n    try {\n      if (!window.ethereum) throw new Error(\"No crypto wallet found\");\n\n      if (activeChain.meta.chainId === 1 || activeChain.meta.chainId === 5) {\n        await window.ethereum.request({\n          method: \"wallet_switchEthereumChain\",\n          params: [\n            {\n              \"chainId\": `0x${Number(activeChain.meta.chainId).toString(16)}`,\n            }\n          ]\n        });\n      } else {\n        await window.ethereum.request({\n          method: \"wallet_addEthereumChain\",          \n          params: [\n            {\n              \"chainId\": `0x${Number(activeChain.meta.chainId).toString(16)}`,\n            }\n          ]\n        });\n      }\n      \n    } catch (err) {\n      setError(err.message);\n    }\n  };\n\n  /* \n    Use effect to update the account states \n  */\n\n  useEffect(() => {\n\n    /* Reset account states to undefined */\n\n    setEthBalance(undefined);\n    setENSName(undefined);\n    setENSAvatar(undefined);\n\n    const account = web3React.account;\n    console.log('wallet provider account:', account);\n\n    if(account && Web3.utils.isAddress(account)) {\n      const ethWeb3 = new Web3(web3React.library);\n\n      /* Balance of the account */\n\n      ethWeb3.eth\n        .getBalance(account)\n        .then(value => {\n          setEthBalance(value ? new BigNumber(value) : undefined);\n        })\n        .catch(Error);\n      \n      /* ENS name and avatar of the account */\n\n      const provider = new ethers.providers.JsonRpcProvider(activeChain.rpc.httpsUrl);\n      provider\n        .lookupAddress(account)\n        .then(value => {\n          setENSName(value ?? undefined);\n          if(value) {\n            provider\n              .getAvatar(value ?? '')\n              .then(value => {\n                setENSAvatar(value ?? undefined);\n              })\n              .catch(Error);\n          }\n        })\n        .catch(Error)\n    }\n  }, [web3React.account, activeChain, web3React.library])\n\n  /* \n    Accroding to session to restore states of the account \n  */\n  \n  useEffect(() => {\n    (async () => {\n      if(sessionProvider) {\n        const walletConnector = WalletConnectors.find(conn => conn.id === sessionProvider);\n\n        if(walletConnector) {\n          await connect(walletConnector)\n        }\n      }\n      setInitialized(true);\n    })()\n  // eslint-disable-next-line\n  },[])\n\n  const value = {\n    initialized,\n    connecting,\n    isActive: web3React.active,\n    account: web3React.account ?? undefined,\n    meta: activeMeta,\n    connector: web3React.connector,\n    provider: web3React.library,\n    ethBalance,\n    connect,\n    disconnect,\n    showWalletsModal: () => {\n      setSelectWalletModal(true);\n    },\n    closeSelectWalletModal: () => {\n      setSelectWalletModal(false)\n    },\n    closeInstallWalletModal: () => {\n      setInstallMetaMaskModal(false)\n    },\n    showSwichChainModal: () => {\n      // setUnsupportedChainModal(false);\n    },\n    changeChain,\n    event,\n    ens: {\n      name: ensName,\n      avatar: ensAvatar,\n    }\n  }\n\n  return (\n    <Context.Provider value={value}>\n      { children }\n      { selectWalletModal && <SelectWalletModal /> }\n      {/* { userRejectedModal && <Modal />}\n      { unsupportedChainModal && <SwitchChainModal />} */}\n      { installMetaMaskModal && <InstallMetamaskModal />}\n    </Context.Provider>\n  )\n}\n\nconst WalletProvider = props => {\n\n  const { children } = props\n\n  return (\n    <Web3ReactProvider getLibrary={library => library}>\n      <Web3WalletProvider>\n        { children }\n      </Web3WalletProvider>\n    </Web3ReactProvider>\n  )\n}\n\nexport default WalletProvider\n"],"mappings":";;;AAAA;;AAEA,SAASA,uBAAuB,EAAEC,YAAY,EAAEC,iBAAiB,QAAQ,kBAAkB;AAC3F,SAASC,uBAAuB,EAAEC,wBAAwB,QAAQ,gCAAgC;AAClG,OAAOC,SAAS,MAAM,cAAc;AACpC,SAASC,MAAM,QAAQ,QAAQ;AAC/B,SAASC,aAAa,EAAEC,WAAW,EAAEC,UAAU,EAAEC,SAAS,EAAEC,OAAO,EAAEC,MAAM,EAAEC,QAAQ,QAAQ,OAAO;AACpG,SAASC,iBAAiB,QAAQ,mBAAmB;AACrD,OAAOC,IAAI,MAAM,MAAM;AACvB,OAAOC,YAAY,MAAM,sBAAsB;AAC/C,SAASC,QAAQ,QAAQ,wBAAwB;AACjD;AACA,OAAOC,oBAAoB,MAAM,0DAA0D;AAC3F,OAAOC,iBAAiB,MAAM,oDAAoD;AAClF;AACA,OAAOC,oBAAoB,MAAM,yCAAyC;;AAE1E;AACA;AACA;AAFA,SAAAC,MAAA,IAAAC,OAAA;AAIA,MAAMC,OAAO,gBAAGhB,aAAa,EAAE;AAE/B,OAAO,SAASiB,SAASA,CAAA,EAAG;EAAAC,EAAA;EAC1B,OAAOhB,UAAU,CAACc,OAAO,CAAC;AAC5B;;AAEA;AACA;AACA;AAFAE,EAAA,CAJgBD,SAAS;AAQzB,OAAO,MAAME,gBAAgB,GAAG,CAC9BN,oBAAoB,CACrB;AAED,MAAMO,kBAAkB,GAAGC,KAAK,IAAI;EAAAC,GAAA;EAAA,IAAAC,kBAAA;EAElC,MAAM;IAAEC;EAAS,CAAC,GAAGH,KAAK;EAC1B,MAAM;IAAEI;EAAY,CAAC,GAAGf,QAAQ,EAAE;EAClC,MAAMgB,SAAS,GAAGhC,YAAY,EAAE;EAEhC,MAAM,CAACiC,eAAe,EAAEC,kBAAkB,EAAEC,qBAAqB,CAAC,GAAGtB,iBAAiB,CAAC,iBAAiB,CAAC;EACzG,MAAMuB,KAAK,GAAG1B,OAAO,CAAC,MAAM,IAAIK,YAAY,EAAE,EAAE,EAAE,CAAC;EACnD,MAAM,CAACsB,UAAU,EAAEC,aAAa,CAAC,GAAG1B,QAAQ,EAAE;EAC9C,MAAM,CAAC2B,WAAW,EAAEC,cAAc,CAAC,GAAG5B,QAAQ,CAAC,KAAK,CAAC;EACrD,MAAM6B,aAAa,GAAG9B,MAAM,CAAC0B,UAAU,CAAC;;EAExC;AACF;AACA;;EAEEI,aAAa,CAACC,OAAO,GAAGL,UAAU;EAClC,MAAM,CAACM,UAAU,EAAEC,aAAa,CAAC,GAAGhC,QAAQ,EAAE;;EAE9C;AACF;AACA;;EAEE,MAAM,CAACiC,UAAU,EAAEC,aAAa,CAAC,GAAGlC,QAAQ,EAAE;EAC9C,MAAM,CAACmC,OAAO,EAAEC,UAAU,CAAC,GAAGpC,QAAQ,EAAE;EACxC,MAAM,CAACqC,SAAS,EAAEC,YAAY,CAAC,GAAEtC,QAAQ,EAAE;;EAE3C;AACF;AACA;;EAEE,MAAM,CAACuC,iBAAiB,EAAEC,oBAAoB,CAAC,GAAGxC,QAAQ,CAAC,KAAK,CAAC;EACjE,MAAM,CAACyC,oBAAoB,EAAEC,uBAAuB,CAAC,GAAG1C,QAAQ,CAAC,KAAK,CAAC;EACvE;EACA;;EAEA;AACF;AACA;;EAEE,MAAM2C,mBAAmB,GAAG5C,MAAM,CAACqB,SAAS,CAACwB,OAAO,CAAC;EACrD,IAAID,mBAAmB,CAACb,OAAO,KAAKV,SAAS,CAACwB,OAAO,EAAE;IACrDD,mBAAmB,CAACb,OAAO,GAAGV,SAAS,CAACwB,OAAO;IAC/CpB,KAAK,CAACqB,IAAI,CAAC,gBAAgB,EAAEzB,SAAS,CAACwB,OAAO,CAAC;EACjD;;EAEA;AACF;AACA;;EAEE,MAAME,UAAU,GAAGnD,WAAW,CAAC,MAAM;IAAA,IAAAoD,qBAAA;IACnC3B,SAAS,CAAC4B,UAAU,EAAE;IACtBjB,UAAU,aAAVA,UAAU,wBAAAgB,qBAAA,GAAVhB,UAAU,CAAEkB,YAAY,cAAAF,qBAAA,uBAAxBA,qBAAA,CAAAG,IAAA,CAAAnB,UAAU,EAAiBX,SAAS,CAAC+B,SAAS,CAAC;IAC/CzB,aAAa,CAAC0B,SAAS,CAAC;IACxBpB,aAAa,CAACoB,SAAS,CAAC;IACxBlB,aAAa,CAACkB,SAAS,CAAC;IACxB7B,qBAAqB,EAAE;EACzB,CAAC,EAAE,CAACH,SAAS,EAAEW,UAAU,EAAER,qBAAqB,EAAEG,aAAa,EAAEM,aAAa,EAAEE,aAAa,CAAC,CAAC;;EAE/F;AACF;AACA;;EAEI,MAAMmB,OAAO,GAAG1D,WAAW,CACzB,MAAO2D,YAAY,IAAK;IAEtB;;IAEA,IAAGzB,aAAa,CAACC,OAAO,EAAE;MACxB;IACF;IAEAD,aAAa,CAACC,OAAO,GAAGwB,YAAY;IACpC5B,aAAa,CAAC4B,YAAY,CAAC;IAE3BC,qBAAqB,CAAC,KAAK,CAAC;IAC5Bb,uBAAuB,CAAC,KAAK,CAAC;IAC9Bc,wBAAwB,CAAC,KAAK,CAAC;IAC/BC,oBAAoB,CAAC,KAAK,CAAC;IAE3B,MAAMN,SAAS,GAAGG,YAAY,CAACI,OAAO,CAACC,aAAa,CAAC;;IAErD;AACR;AACA;AACA;AACA;;IAEQ,SAASC,OAAOA,CAACC,KAAK,EAAE;MACtB,IAAGA,KAAK,YAAYvE,uBAAuB,EAAE;QAC3CoD,uBAAuB,CAAC,IAAI,CAAC;QAC7BI,UAAU,EAAE;MACd,CAAC,MAAM,IAAGe,KAAK,YAAY1E,uBAAuB,EAAE;QAClDqE,wBAAwB,CAAC,IAAI,CAAC;QAC9BV,UAAU,EAAE;MACd,CAAC,MAAM,IAAGe,KAAK,YAAYtE,wBAAwB,EAAE;QACnDkE,oBAAoB,CAAC,IAAI,CAAC;QAC1BX,UAAU,EAAE;MACd,CAAC,MAAM;QAAA,IAAAgB,qBAAA;QACL,MAAMC,GAAG,IAAAD,qBAAA,GAAGR,YAAY,CAACM,OAAO,cAAAE,qBAAA,uBAApBA,qBAAA,CAAAZ,IAAA,CAAAI,YAAY,EAAWO,KAAK,CAAC;QAEzC,IAAGE,GAAG,EAAE;UACNC,OAAO,CAACC,GAAG,CAACF,GAAG,CAACG,OAAO,CAAC;QAC1B;QACApB,UAAU,EAAE;MACd;IACF;IAEA,SAASqB,SAASA,CAAA,EAAG;MAAA,IAAAC,qBAAA;MACnB,IAAI,CAACvC,aAAa,CAACC,OAAO,EAAE;QAC1B;MACF;MAEA,CAAAsC,qBAAA,GAAAd,YAAY,CAACe,SAAS,cAAAD,qBAAA,uBAAtBA,qBAAA,CAAAlB,IAAA,CAAAI,YAAY,EAAaH,SAAS,CAAC;MACnCnB,aAAa,CAACsB,YAAY,CAAC;MAC3BhC,kBAAkB,CAACgC,YAAY,CAACgB,EAAE,CAAC;MACnCN,OAAO,CAACC,GAAG,CAAC,yBAAyB,CAAC;IACxC;IAEA,MAAM7C,SAAS,CAACmD,QAAQ,CAACpB,SAAS,EAAEC,SAAS,EAAE,IAAI,CAAC,CAACoB,IAAI,CAACL,SAAS,CAAC,CAACM,KAAK,CAACb,OAAO,CAAC;IACnFlC,aAAa,CAAC0B,SAAS,CAAC;;IAExB;;IAEA;;IAEA;IACA;IACA;IACA;IACA;IACA;IACA;;IAEA;;IAEA;IACA;IACA;IACA;IACA;IACA;EACF,CAAC,EACD,CAAChC,SAAS,EAAES,aAAa,EAAEH,aAAa,EAAEJ,kBAAkB,EAAEqC,aAAa,EAAEb,UAAU,CAAC,CACzF;EAEH,MAAM4B,WAAW,GAAG,MAAOC,QAAQ,IAAK;IACtC,IAAI;MACF,IAAI,CAACC,MAAM,CAACC,QAAQ,EAAE,MAAM,IAAIC,KAAK,CAAC,wBAAwB,CAAC;MAE/D,IAAI3D,WAAW,CAAC4D,IAAI,CAACC,OAAO,KAAK,CAAC,IAAI7D,WAAW,CAAC4D,IAAI,CAACC,OAAO,KAAK,CAAC,EAAE;QACpE,MAAMJ,MAAM,CAACC,QAAQ,CAACI,OAAO,CAAC;UAC5BC,MAAM,EAAE,4BAA4B;UACpCC,MAAM,EAAE,CACN;YACE,SAAS,EAAG,KAAIC,MAAM,CAACjE,WAAW,CAAC4D,IAAI,CAACC,OAAO,CAAC,CAACK,QAAQ,CAAC,EAAE,CAAE;UAChE,CAAC;QAEL,CAAC,CAAC;MACJ,CAAC,MAAM;QACL,MAAMT,MAAM,CAACC,QAAQ,CAACI,OAAO,CAAC;UAC5BC,MAAM,EAAE,yBAAyB;UACjCC,MAAM,EAAE,CACN;YACE,SAAS,EAAG,KAAIC,MAAM,CAACjE,WAAW,CAAC4D,IAAI,CAACC,OAAO,CAAC,CAACK,QAAQ,CAAC,EAAE,CAAE;UAChE,CAAC;QAEL,CAAC,CAAC;MACJ;IAEF,CAAC,CAAC,OAAOtB,GAAG,EAAE;MACZY,QAAQ,CAACZ,GAAG,CAACG,OAAO,CAAC;IACvB;EACF,CAAC;;EAED;AACF;AACA;;EAEErE,SAAS,CAAC,MAAM;IAEd;;IAEAqC,aAAa,CAACkB,SAAS,CAAC;IACxBhB,UAAU,CAACgB,SAAS,CAAC;IACrBd,YAAY,CAACc,SAAS,CAAC;IAEvB,MAAMR,OAAO,GAAGxB,SAAS,CAACwB,OAAO;IACjCoB,OAAO,CAACC,GAAG,CAAC,0BAA0B,EAAErB,OAAO,CAAC;IAEhD,IAAGA,OAAO,IAAI1C,IAAI,CAACoF,KAAK,CAACC,SAAS,CAAC3C,OAAO,CAAC,EAAE;MAC3C,MAAM4C,OAAO,GAAG,IAAItF,IAAI,CAACkB,SAAS,CAACqE,OAAO,CAAC;;MAE3C;;MAEAD,OAAO,CAACE,GAAG,CACRC,UAAU,CAAC/C,OAAO,CAAC,CACnB4B,IAAI,CAACoB,KAAK,IAAI;QACb1D,aAAa,CAAC0D,KAAK,GAAG,IAAIpG,SAAS,CAACoG,KAAK,CAAC,GAAGxC,SAAS,CAAC;MACzD,CAAC,CAAC,CACDqB,KAAK,CAACK,KAAK,CAAC;;MAEf;;MAEA,MAAMe,QAAQ,GAAG,IAAIpG,MAAM,CAACqG,SAAS,CAACC,eAAe,CAAC5E,WAAW,CAAC6E,GAAG,CAACC,QAAQ,CAAC;MAC/EJ,QAAQ,CACLK,aAAa,CAACtD,OAAO,CAAC,CACtB4B,IAAI,CAACoB,KAAK,IAAI;QACbxD,UAAU,CAACwD,KAAK,aAALA,KAAK,cAALA,KAAK,GAAIxC,SAAS,CAAC;QAC9B,IAAGwC,KAAK,EAAE;UACRC,QAAQ,CACLM,SAAS,CAACP,KAAK,aAALA,KAAK,cAALA,KAAK,GAAI,EAAE,CAAC,CACtBpB,IAAI,CAACoB,KAAK,IAAI;YACbtD,YAAY,CAACsD,KAAK,aAALA,KAAK,cAALA,KAAK,GAAIxC,SAAS,CAAC;UAClC,CAAC,CAAC,CACDqB,KAAK,CAACK,KAAK,CAAC;QACjB;MACF,CAAC,CAAC,CACDL,KAAK,CAACK,KAAK,CAAC;IACjB;EACF,CAAC,EAAE,CAAC1D,SAAS,CAACwB,OAAO,EAAEzB,WAAW,EAAEC,SAAS,CAACqE,OAAO,CAAC,CAAC;;EAEvD;AACF;AACA;;EAEE5F,SAAS,CAAC,MAAM;IACd,CAAC,YAAY;MACX,IAAGwB,eAAe,EAAE;QAClB,MAAM+E,eAAe,GAAGvF,gBAAgB,CAACwF,IAAI,CAACC,IAAI,IAAIA,IAAI,CAAChC,EAAE,KAAKjD,eAAe,CAAC;QAElF,IAAG+E,eAAe,EAAE;UAClB,MAAM/C,OAAO,CAAC+C,eAAe,CAAC;QAChC;MACF;MACAxE,cAAc,CAAC,IAAI,CAAC;IACtB,CAAC,GAAG;IACN;EACA,CAAC,EAAC,EAAE,CAAC;EAEL,MAAMgE,KAAK,GAAG;IACZjE,WAAW;IACXF,UAAU;IACV8E,QAAQ,EAAEnF,SAAS,CAACoF,MAAM;IAC1B5D,OAAO,GAAA3B,kBAAA,GAAEG,SAAS,CAACwB,OAAO,cAAA3B,kBAAA,cAAAA,kBAAA,GAAImC,SAAS;IACvC2B,IAAI,EAAEhD,UAAU;IAChBoB,SAAS,EAAE/B,SAAS,CAAC+B,SAAS;IAC9B0C,QAAQ,EAAEzE,SAAS,CAACqE,OAAO;IAC3BxD,UAAU;IACVoB,OAAO;IACPP,UAAU;IACV2D,gBAAgB,EAAEA,CAAA,KAAM;MACtBjE,oBAAoB,CAAC,IAAI,CAAC;IAC5B,CAAC;IACDkE,sBAAsB,EAAEA,CAAA,KAAM;MAC5BlE,oBAAoB,CAAC,KAAK,CAAC;IAC7B,CAAC;IACDmE,uBAAuB,EAAEA,CAAA,KAAM;MAC7BjE,uBAAuB,CAAC,KAAK,CAAC;IAChC,CAAC;IACDkE,mBAAmB,EAAEA,CAAA,KAAM;MACzB;IAAA,CACD;IACDlC,WAAW;IACXlD,KAAK;IACLqF,GAAG,EAAE;MACHC,IAAI,EAAE3E,OAAO;MACb4E,MAAM,EAAE1E;IACV;EACF,CAAC;EAED,oBACE5B,OAAA,CAACC,OAAO,CAACsG,QAAQ;IAACpB,KAAK,EAAEA,KAAM;IAAA1E,QAAA,GAC3BA,QAAQ,EACRqB,iBAAiB,iBAAI9B,OAAA,CAACH,iBAAiB;MAAA2G,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,QAAG,EAG1C3E,oBAAoB,iBAAIhC,OAAA,CAACJ,oBAAoB;MAAA4G,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,QAAG;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,QACjC;AAEvB,CAAC;AAAApG,GAAA,CAxRKF,kBAAkB;EAAA,QAGEV,QAAQ,EACdhB,YAAY,EAEuCa,iBAAiB;AAAA;AAAAoH,EAAA,GANlFvG,kBAAkB;AA0RxB,MAAMwG,cAAc,GAAGvG,KAAK,IAAI;EAE9B,MAAM;IAAEG;EAAS,CAAC,GAAGH,KAAK;EAE1B,oBACEN,OAAA,CAACpB,iBAAiB;IAACkI,UAAU,EAAE9B,OAAO,IAAIA,OAAQ;IAAAvE,QAAA,eAChDT,OAAA,CAACK,kBAAkB;MAAAI,QAAA,EACfA;IAAQ;MAAA+F,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EACS;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,QACH;AAExB,CAAC;AAAAI,GAAA,GAXKF,cAAc;AAapB,eAAeA,cAAc;AAAA,IAAAD,EAAA,EAAAG,GAAA;AAAAC,YAAA,CAAAJ,EAAA;AAAAI,YAAA,CAAAD,GAAA"},"metadata":{},"sourceType":"module"}