import { useRef, useCallback } from 'react';

/**
 * useFocusWithin
 * @description Handles focus events for the target component.
 * @see {@link https://rooks.vercel.app/docs/useFocusWithin}
 */
const useFocusWithin = (props) => {
    const { onBlurWithin, onFocusWithin, onFocusWithinChange } = props;
    const state = useRef({
        isFocusWithin: false,
    });
    const onBlur = useCallback((e) => {
        if (state.current.isFocusWithin &&
            !e.currentTarget.contains(e.relatedTarget)) {
            state.current.isFocusWithin = false;
            if (onBlurWithin)
                onBlurWithin(e);
            if (onFocusWithinChange)
                onFocusWithinChange(false);
        }
    }, [onBlurWithin, onFocusWithinChange]);
    const onFocus = useCallback((e) => {
        if (!state.current.isFocusWithin) {
            if (onFocusWithin)
                onFocusWithin(e);
            if (onFocusWithinChange)
                onFocusWithinChange(true);
            state.current.isFocusWithin = true;
        }
    }, [onFocusWithin, onFocusWithinChange]);
    return {
        focusWithinProps: {
            onFocus,
            onBlur,
        },
    };
};

export { useFocusWithin };
